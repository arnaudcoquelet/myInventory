<!--<link rel='stylesheet' href='/stylesheets/summernote-bs3.css' /> -->
<link rel='stylesheet' href='/stylesheets/summernote.css' />
<script src="/js/summernote.js"></script>


<script src="/js/angular_siteDetails.js"></script>

<div ng-controller="ctrlSiteDetails" class="panel panel-default" style="border-top: medium none; border-top-left-radius: 0px; border-top-right-radius: 0px;">
    <div ng-init="fecthItems()"></div>
    <div class="panel-body">
        <div class="col-lg-6">
            <i class="fa fa-map-marker"></i> <b>Address : </b> <a href="#modalAddSiteAddress" role="button" data-toggle="modal" class="glyphicon glyphicon-plus-sign text-success" style="padding-left: 5px" title="Edit site address"></a>
            <div class="list-address">
                <ul class="addressList" style="padding:0; list-style:none; min-height:50px;   overflow:auto;">
                    <div ng-repeat="address in item.addresses">
                        <li style="margin:0; margin-top:10px;" ng-mouseover="address.edit=true" ng-mouseleave="address.edit=false">
                            <div class="addressImage" style="display: table-cell width:30px; margin-right:5px; height:30px; float:left;">
                                <img src="/img/map.png" style="width:100%; border-radius:50%;">
                            </div>
                            <div class="addressName" style="display: table-cell; height:30px; vertical-align: middle;">
                                <p class="" style="margin:0;">
                                    <a href="http://maps.google.com/?q={{address.address1}}, {{address.city}}, {{address.state}} {{address.zipcode}}" target="_blank" class="text-muted" >{{address.address1}}, {{address.city}}, {{address.state}} {{address.zipcode}} </a>
                                    <a href="#modalEditSiteAddress" ng-show="address.edit" data-toggle="modal" data-id="{{address.id}}" data-address1="{{address.address1}}" data-city="{{address.city}}" data-state="{{address.state}}" data-zipcode="{{address.zipcode}}" class="open-editSiteAddress glyphicon glyphicon-pencil text-primary" style="padding-left: 10px" title="edit"></a>
                                    <a href="#modalDeleteSiteAddress" ng-show="address.edit" data-toggle="modal" data-id="{{address.id}}" data-address1="{{address.address1}}" data-city="{{address.city}}" data-state="{{address.state}}" data-zipcode="{{address.zipcode}}" class="open-DeleteSiteAddress glyphicon glyphicon-remove text-danger" title="delete"></a>
                                </p>
                            </div>
                        </li>
                    </div>
                </ul>
            </div>
            </br>
        </div>
        <div class="col-lg-6">
            <i class="fa fa-users"></i> <b>Contact(s) : </b><a href="#modalAddSiteContact" role="button" data-toggle="modal" class="glyphicon glyphicon-plus-sign text-success" style="padding-left: 5px" title="Assign a contact"></a>
            <div class="list-contact">
                <ul class="contactList" style="padding:0; list-style:none; min-height:50px;   overflow:auto;">
                    <div ng-repeat="contact in item.contacts">
                        <li style="margin:0; margin-top:10px;" ng-mouseover="contact.edit=true" ng-mouseleave="contact.edit=false">
                            <div class="contactImage"
                                 style="display: table-cell width:30px; margin-right:5px; height:30px; float:left;">
                                <img src="/img/avatars/avatar-30px.png" style="width:100%; border-radius:50%;">
                            </div>
                            <div class="contactName" style="display: table-cell; height:30px; vertical-align: middle;">
                                <p class="" style="margin:0;">
                                    <a href="/admin/user/{{contact.id}}" class="text-muted"><b>{{contact.name}}</b></a>
                                    <a href="#modalDeleteSiteAddress" ng-show="contact.edit" data-toggle="modal" data-id="{{contact.id}}" class="open-DeleteSiteContact glyphicon glyphicon-remove text-danger" style="padding-left: 5px" title="delete"></a>
                                </p>
                            </div>
                        </li>
                    </div>
                </ul>
            </div>
            </br>
        </div>
        <div class="col-lg-6">
            <i class="fa fa-clock-o"></i> <b>Hour(s) : </b>  <b class="text-muted"> <%= site.category%> </b> <!-- <a href="#modalAddSiteContact" role="button" data-toggle="modal" class="glyphicon glyphicon-plus-sign text-success" style="padding-left: 5px" title="Assign a contact"></a> -->

            </br>
        </div>
        <div class="col-lg-6">
            <i class="fa fa-file-o"></i> <b>Note(s) : </b><a href="#modalAddSiteNote" role="button" data-toggle="modal" class="glyphicon glyphicon-plus-sign text-success" style="padding-left: 5px" title="Add a new note"></a>
            <div class="list-note">
                <ul class="noteList" style="padding:0; list-style:none; min-height:50px;   overflow:auto;">
                    <div ng-repeat="note in item.notes">
                    <li style="margin:0; margin-top:10px;">
                        <div class="noteImage" style="display: table-cell width:30px; margin-right:5px; height:40px; float:left;">
                            <img src="/img/note.png" style="width:30px; margin-top: 5px">
                        </div>
                        <div class="noteText" style="display: table-cell">
                            <p class="" style="margin:0;">
                                <a href="/note/{{note.id}}" target="_blank" class="text-muted"><b>{{note.title}}</b></a></p>
                            <span class="date sub-text" style="color:#aaa; font-family:verdana; font-size:11px;">on {{customDateFormat(note.updatedAt)}} by _____ </span>
                        </div>
                    </li>
                    </div>
                </ul>
            </div>
        </div>
        </br>
    </div>
</div>


<!--Modals-->
<div class="modal" tabindex="-1" role="dialog" id="modalAddSiteContact" aria-labelledby="modalAddLabel"
     aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <a class="close" data-dismiss="modal">&times;</a>
                <h3>Add a User</h3>
            </div>
            <div class="modal-body">
                <form role="form" class="form-horizontal" action="/sitegroup/<%= sitegroup.id%>/site/<%= site.id%>/contacts/add" method="post">
                    <input type="hidden" name="sitegroupid" value="<%= sitegroup.id%>" class="hidden">
                    <input type="hidden" name="siteid" value="<%= site.id%>" class="hidden">
                    <div class="form-group">
                        <div class="col-lg-12">
                            <% include userSelectLayout %>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="col-lg-12">
                        <button type="submit" class="btn btn-success btn-block">Add</button>
                        </div>
                    </div>
                </form>
            </div>

        </div>
    </div>
</div>

<div class="modal" role="dialog" id="modalDeleteSiteContact" aria-labelledby="modalDeleteLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content col-md-8">
            <div class="modal-header">
                <a class="close" data-dismiss="modal">&times;</a>
                <h3>You are about to remove a Contact from the Site</h3>
            </div>
            <div class="modal-body">
                <form role="form" id="deleteForm" class="form-horizontal" action="/sitegroup/<%= sitegroup.id%>/site/<%= site.id%>/contacts/remove" method="post">
                    <div class="form-group">
                        <div class="deleteUserFields">
                            <input type="hidden" class="form-control" id="contactid" name="contactid"/>
                            <input type="hidden" class="form-control" name="sitegroupid" value="<%= sitegroup.id%>">
                            <input type="hidden" class="form-control" name="siteid" value="<%= site.id%>">
                            <input type="text" class="form-control" id="name" name="name" placeholder="Name" autofocus/>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="">
                            <button type="submit" class="btn btn-danger btn-block">Delete</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<script>
        $(document).on("click", ".open-DeleteSiteContact", function () {
                var contactid = $(this).data('contactid');
                var name = $(this).data('name');
                $(".deleteUserFields #contactid").val( contactid );
                $(".deleteUserFields #name").val( name );
            })
</script>

<div class="modal" role="dialog" id="modalDeleteSiteAddress" aria-labelledby="modalDeleteLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content col-md-8">
            <div class="modal-header">
                <a class="close" data-dismiss="modal">&times;</a>
                <h3>You are about to remove a Address from the Site</h3>
            </div>
            <div class="modal-body">
                <form role="form" id="deleteForm" class="form-horizontal" action="/sitegroup/<%= sitegroup.id%>/site/<%= site.id%>/addresses/remove" method="post">
                    <div class="form-group">
                        <div class="deleteSiteAddressFields">
                            <input type="hidden" class="form-control" id="addressid" name="addressid"/>
                            <input type="hidden" class="form-control" name="sitegroupid" value="<%= sitegroup.id%>">
                            <input type="hidden" class="form-control" name="siteid" value="<%= site.id%>">
                            <input type="text" class="form-control" id="address1" name="address1" placeholder="Street" autofocus/>
                            <input type="text" class="form-control" id="city" name="city" placeholder="City"/>
                            <input type="text" class="form-control" id="state" name="state" placeholder="State"/>
                            <input type="text" class="form-control" id="zipcode" name="zipcode" placeholder="Zip Code"/>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="">
                            <button type="submit" class="btn btn-danger btn-block">Delete</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<script>
        $(document).on("click", ".open-DeleteSiteAddress", function () {
                var id = $(this).data('id');
                var address1 = $(this).data('address1');
                var city = $(this).data('city');
                var state = $(this).data('state');
                var zipcode = $(this).data('zipcode');
                $(".deleteSiteAddressFields #addressid").val( id );
                $(".deleteSiteAddressFields #address1").val( address1 );
                $(".deleteSiteAddressFields #city").val( city );
                $(".deleteSiteAddressFields #state").val( state );
                $(".deleteSiteAddressFields #zipcode").val( zipcode );
            })
</script>

<div class="modal" tabindex="-1" role="dialog" id="modalAddSiteAddress" aria-labelledby="modalAddLabel"
     aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <a class="close" data-dismiss="modal">&times;</a>

                <h3>Add a New Address</h3>
            </div>
            <div class="modal-body">
                <form role="form" class="form-horizontal" action="/sitegroup/<%= sitegroup.id%>/site/<%= site.id%>/addresses/add" method="post">
                    <input type="hidden" name="sitegroupid" value="<%= sitegroup.id%>" class="hidden">
                    <input type="hidden" name="siteid" value="<%= site.id%>" class="hidden">

                    <div class="form-group">
                        <label class="col-md-2 control-label" for="address1">Street</label>

                        <div class="col-md-8">
                            <input type="text" class="form-control" id="address1" name="address1" placeholder="Street"
                                   autofocus/>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-md-2 control-label" for="city">City</label>

                        <div class="col-md-8">
                            <input type="text" class="form-control" id="city" name="city" placeholder="City"/>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-md-2 control-label" for="state">State</label>

                        <div class="col-md-8">
                            <select id="state" name="state" class="addressStateSelectPicker" data-width="100%">
                                <option value="AL">Alabama</option>
                                <option value="AK">Alaska</option>
                                <option value="AZ">Arizona</option>
                                <option value="AR">Arkansas</option>
                                <option value="CA">California</option>
                                <option value="CO">Colorado</option>
                                <option value="CT">Connecticut</option>
                                <option value="DE">Delaware</option>
                                <option value="DC">District Of Columbia</option>
                                <option value="FL">Florida</option>
                                <option value="GA">Georgia</option>
                                <option value="HI">Hawaii</option>
                                <option value="ID">Idaho</option>
                                <option value="IL">Illinois</option>
                                <option value="IN">Indiana</option>
                                <option value="IA">Iowa</option>
                                <option value="KS">Kansas</option>
                                <option value="KY">Kentucky</option>
                                <option value="LA">Louisiana</option>
                                <option value="ME">Maine</option>
                                <option value="MD">Maryland</option>
                                <option value="MA">Massachusetts</option>
                                <option value="MI">Michigan</option>
                                <option value="MN">Minnesota</option>
                                <option value="MS">Mississippi</option>
                                <option value="MO">Missouri</option>
                                <option value="MT">Montana</option>
                                <option value="NE">Nebraska</option>
                                <option value="NV">Nevada</option>
                                <option value="NH">New Hampshire</option>
                                <option value="NJ">New Jersey</option>
                                <option value="NM">New Mexico</option>
                                <option value="NY">New York</option>
                                <option value="NC">North Carolina</option>
                                <option value="ND">North Dakota</option>
                                <option value="OH">Ohio</option>
                                <option value="OK">Oklahoma</option>
                                <option value="OR">Oregon</option>
                                <option value="PA" selected="selected">Pennsylvania</option>
                                <option value="RI">Rhode Island</option>
                                <option value="SC">South Carolina</option>
                                <option value="SD">South Dakota</option>
                                <option value="TN">Tennessee</option>
                                <option value="TX">Texas</option>
                                <option value="UT">Utah</option>
                                <option value="VT">Vermont</option>
                                <option value="VA">Virginia</option>
                                <option value="WA">Washington</option>
                                <option value="WV">West Virginia</option>
                                <option value="WI">Wisconsin</option>
                                <option value="WY">Wyoming</option>
                                <option value="">Other</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-md-2 control-label" for="zipcode">Zip Code</label>

                        <div class="col-md-8">
                            <input type="text" class="form-control" id="zipcode" name="zipcode" placeholder="Zip Code"/>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-md-2 control-label" for="submitbutton"></label>

                        <div class="col-md-8">
                            <button type="submit" id="submitbutton" class="btn btn-success btn-block">Add</button>
                        </div>
                    </div>
                </form>
            </div>

        </div>
    </div>
</div>

<div class="modal" tabindex="-1" role="dialog" id="modalEditSiteAddress" aria-labelledby="modalAddLabel"
     aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <a class="close" data-dismiss="modal">&times;</a>

                <h3>Update Address</h3>
            </div>
            <div class="modal-body">
                <form role="form" class="form-horizontal editSiteAddress" action="/sitegroup/<%= sitegroup.id%>/site/<%= site.id%>/addresses/update" method="post">
                    <input type="hidden" name="sitegroupid" value="<%= sitegroup.id%>" class="hidden">
                    <input type="hidden" name="siteid" value="<%= site.id%>" class="hidden">
                    <input type="hidden" name="addressid" id="addressid" value="" class="hidden">

                    <div class="form-group">
                        <label class="col-md-2 control-label" for="address1">Street</label>

                        <div class="col-md-8">
                            <input type="text" class="form-control" id="address1" name="address1" placeholder="Street"
                                   autofocus/>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-md-2 control-label" for="city">City</label>

                        <div class="col-md-8">
                            <input type="text" class="form-control" id="city" name="city" placeholder="City"/>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-md-2 control-label" for="state">State</label>

                        <div class="col-md-8">
                            <select id="state" name="state" class="addressStateSelectPicker" data-width="100%">
                                <option value="AL">Alabama</option>
                                <option value="AK">Alaska</option>
                                <option value="AZ">Arizona</option>
                                <option value="AR">Arkansas</option>
                                <option value="CA">California</option>
                                <option value="CO">Colorado</option>
                                <option value="CT">Connecticut</option>
                                <option value="DE">Delaware</option>
                                <option value="DC">District Of Columbia</option>
                                <option value="FL">Florida</option>
                                <option value="GA">Georgia</option>
                                <option value="HI">Hawaii</option>
                                <option value="ID">Idaho</option>
                                <option value="IL">Illinois</option>
                                <option value="IN">Indiana</option>
                                <option value="IA">Iowa</option>
                                <option value="KS">Kansas</option>
                                <option value="KY">Kentucky</option>
                                <option value="LA">Louisiana</option>
                                <option value="ME">Maine</option>
                                <option value="MD">Maryland</option>
                                <option value="MA">Massachusetts</option>
                                <option value="MI">Michigan</option>
                                <option value="MN">Minnesota</option>
                                <option value="MS">Mississippi</option>
                                <option value="MO">Missouri</option>
                                <option value="MT">Montana</option>
                                <option value="NE">Nebraska</option>
                                <option value="NV">Nevada</option>
                                <option value="NH">New Hampshire</option>
                                <option value="NJ">New Jersey</option>
                                <option value="NM">New Mexico</option>
                                <option value="NY">New York</option>
                                <option value="NC">North Carolina</option>
                                <option value="ND">North Dakota</option>
                                <option value="OH">Ohio</option>
                                <option value="OK">Oklahoma</option>
                                <option value="OR">Oregon</option>
                                <option value="PA">Pennsylvania</option>
                                <option value="RI">Rhode Island</option>
                                <option value="SC">South Carolina</option>
                                <option value="SD">South Dakota</option>
                                <option value="TN">Tennessee</option>
                                <option value="TX">Texas</option>
                                <option value="UT">Utah</option>
                                <option value="VT">Vermont</option>
                                <option value="VA">Virginia</option>
                                <option value="WA">Washington</option>
                                <option value="WV">West Virginia</option>
                                <option value="WI">Wisconsin</option>
                                <option value="WY">Wyoming</option>
                                <option value="">Other</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-md-2 control-label" for="zipcode">Zip Code</label>

                        <div class="col-md-8">
                            <input type="text" class="form-control" id="zipcode" name="zipcode" placeholder="Zip Code"/>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-md-2 control-label" for="submitbutton"></label>

                        <div class="col-md-8">
                            <button type="submit" id="submitbutton" class="btn btn-primary btn-block">Update</button>
                        </div>
                    </div>
                </form>
            </div>

        </div>
    </div>
</div>
<script>
        $(document).on("click", ".open-editSiteAddress", function () {
                var addressid = $(this).data('id');
                var address1 = $(this).data('address1');
                var city = $(this).data('city');
                var state = $(this).data('state');
                var zipcode = $(this).data('zipcode');

                $(".editSiteAddress #addressid").val( addressid );
                $(".editSiteAddress #address1").val( address1 );
                $(".editSiteAddress #city").val( city );
                $(".editSiteAddress #state").val(state).change();
                $(".editSiteAddress #addressid").val( addressid );
                $(".editSiteAddress #zipcode").val( zipcode );
            })
</script>
<script>
    $('.addressStateSelectPicker').selectpicker();
</script>

<div class="modal" tabindex="-1" role="dialog" id="modalAddSiteNote" aria-labelledby="modalAddLabel"
     aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <a class="close" data-dismiss="modal">&times;</a>
                <h3>Add a New Note</h3>
            </div>
            <div class="modal-body">
                <form role="form" id="addSiteNoteForm"class="form-horizontal" action="/sitegroup/<%= sitegroup.id%>/site/<%= site.id%>/notes/add" method="post">
                    <input type="hidden" name="sitegroupid" value="<%= sitegroup.id%>" class="hidden">
                    <input type="hidden" name="siteid" value="<%= site.id%>" class="hidden">
                    <input type="hidden" name="addSiteNoteFormNotetext" id="addSiteNoteFormNotetext" value="" class="hidden">

                    <div class="form-group">
                        <label class="col-md-2 control-label" for="title">Title</label>
                        <div class="col-md-8">
                            <input type="text" class="form-control" id="title" name="title" placeholder="Title" autofocus/>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-md-2 control-label" for="title">Note</label>
                        <div class="col-md-8">
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="col-md-12">
                            <div class="summernote" id="addSiteNoteSummernote"></div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-md-2 control-label" for="submitbutton"></label>

                        <div class="col-md-8">
                            <button type="submit" id="addSiteNoteFormButton" class="btn btn-success btn-block">Add</button>
                        </div>
                    </div>
                </form>
            </div>

        </div>
    </div>
</div>
<script>
    $(document).ready(function() {
      $('.summernote').summernote({
        height: 300,                 // set editor height
        minHeight: 100,             // set minimum height of editor
        maxHeight: 500,             // set maximum height of editor
      });
    });

    $(document).on("click", "#addSiteNoteFormButton", function () {
        var note =$('#addSiteNoteSummernote').code();
            $("#addSiteNoteFormNotetext").val(note);
    });
</script>